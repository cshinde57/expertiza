  <% if @map.survey? %>
    <h1><%= @title %> for <%= @survey_parent.name %></h1>
<% else %>
    <h1><%= @title %> for <%= @assignment.name %></h1>
<% end %>

<% if !(@map.instance_of? TeammateReviewResponseMap) && !@map.survey? %>
  <% topic_id = SignedUpTeam.topic_id(@participant.parent_id, @participant.user_id) %>
  <%= render :partial => 'submitted_content/main', :locals => {:participant => @contributor.participants.first, :stage => @assignment.get_current_stage(topic_id)} %>
<% end %>
<% @review_versions = @map.get_all_versions() %>
<% if !@review_versions.empty? %>
    <%= @review_versions.each do |response| %>
    	<%= response.display_as_html() %>
        <br/>
    <% end %>
    <hr/>
<% end %>
  <!--Check whether there is a UploadFile question1.-->
<% file_url = nil %>
Latest response:
<%= @response.display_as_html(nil, nil, file_url) %>
  <br/>
Old responses:
  <br/>
  <% @conflicting_ids.each do |id| %>
      <% @conflicting_response = Response.find(id) %>
      <% @map = @conflicting_response.map %>
      <% set_content %>
      <% file_url = nil %>
      <%= @conflicting_response.display_as_html %>
      <br />
  <% end %>
<br/>

<!--Check whether there is a UploadFile question.-->
<%if @map.instance_of?(ReviewResponseMap)%>
<% current_folder = DisplayOption.new %>
<% current_folder.name = "" %>
<% response_map_id = Response.find(params[:id]).response_map.id %>
<% files = @participant.files(@participant.review_file_path(response_map_id).to_s + current_folder.name) %>
<%session_participant = AssignmentParticipant.where(parent_id: @assignment.id, user_id: session[:user].id).first%>
<%session_participants_team = AssignmentTeam.team(session_participant)%>
<%@questions.each do |question| %>
    <% if question.instance_of? UploadFile %>
        <%= display_directory_tree(@participant, files, true).html_safe %>
    <% end %>
<% end %>
<%end%>

<%= @map.show_feedback(@response) %>
<br/>
<a href="javascript:window.history.back()">Back</a>
